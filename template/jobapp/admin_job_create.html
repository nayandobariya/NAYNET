{% extends "base_admin.html" %}
{% load static %}

{% block title %}Create Job | Admin Panel{% endblock %}
{% block page_title %}Create New Job{% endblock %}

{% block content %}
<div class="row justify-content-center fade-in">
    <div class="col-lg-12">
        <div class="card mb-4">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h5 class="mb-0 text-primary fw-bold"><i class="fas fa-briefcase me-2"></i> New Job Details</h5>
                <a href="{% url 'jobapp:admin-jobs' %}" class="btn btn-outline-primary btn-sm">
                    <i class="fas fa-arrow-left me-1"></i> Back to Jobs
                </a>
            </div>
        </div>

        <div class="card fade-in" style="animation-delay: 0.1s;">
            <div class="card-body p-4">
                <form method="post">
                    {% csrf_token %}

                    <h6 class="text-uppercase text-muted fw-bold mb-3 small">Basic Information</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="{{ form.title.id_for_label }}" class="form-label fw-bold small text-muted">Job
                                Title</label>
                            {{ form.title }}
                            {% if form.title.errors %}
                            <div class="text-danger small mt-1">{{ form.title.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <label for="{{ form.company_name.id_for_label }}"
                                class="form-label fw-bold small text-muted">Company Name</label>
                            {{ form.company_name }}
                            {% if form.company_name.errors %}
                            <div class="text-danger small mt-1">{{ form.company_name.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <label for="{{ form.location.id_for_label }}"
                                class="form-label fw-bold small text-muted">Location</label>
                            {{ form.location }}
                            {% if form.location.errors %}
                            <div class="text-danger small mt-1">{{ form.location.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <label for="{{ form.category.id_for_label }}"
                                class="form-label fw-bold small text-muted">Category</label>
                            {{ form.category }}
                            {% if form.category.errors %}
                            <div class="text-danger small mt-1">{{ form.category.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <h6 class="text-uppercase text-muted fw-bold mb-3 small">Job Details</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <label for="{{ form.job_type.id_for_label }}"
                                class="form-label fw-bold small text-muted">Job Type</label>
                            {{ form.job_type }}
                            {% if form.job_type.errors %}
                            <div class="text-danger small mt-1">{{ form.job_type.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-4">
                            <label for="{{ form.salary.id_for_label }}"
                                class="form-label fw-bold small text-muted">Salary</label>
                            {{ form.salary }}
                            {% if form.salary.errors %}
                            <div class="text-danger small mt-1">{{ form.salary.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-4">
                            <label for="{{ form.last_date.id_for_label }}"
                                class="form-label fw-bold small text-muted">Last Date</label>
                            {{ form.last_date }}
                            {% if form.last_date.errors %}
                            <div class="text-danger small mt-1">{{ form.last_date.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-12">
                            <label for="{{ form.url.id_for_label }}" class="form-label fw-bold small text-muted">Website
                                URL</label>
                            {{ form.url }}
                            {% if form.url.errors %}
                            <div class="text-danger small mt-1">{{ form.url.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <h6 class="text-uppercase text-muted fw-bold mb-3 small">Descriptions</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-12">
                            <label class="form-label fw-bold small text-muted">Job Description</label>
                            <div id="description-editor" style="height: 200px; margin-bottom: 20px;"></div>
                            <input type="hidden" name="description" id="id_description">
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold small text-muted">Company Description</label>
                            <div id="company-description-editor" style="height: 150px; margin-bottom: 20px;"></div>
                            <input type="hidden" name="company_description" id="id_company_description">
                        </div>
                    </div>

                    <h6 class="text-uppercase text-muted fw-bold mb-3 small">Settings</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <label for="{{ form.user.id_for_label }}" class="form-label fw-bold small text-muted">Posted
                                By</label>
                            {{ form.user }}
                            {% if form.user.errors %}
                            <div class="text-danger small mt-1">{{ form.user.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-4">
                            <div class="form-check form-switch mt-4">
                                {{ form.is_published }}
                                <label class="form-check-label fw-bold"
                                    for="{{ form.is_published.id_for_label }}">Published</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check form-switch mt-4">
                                {{ form.is_closed }}
                                <label class="form-check-label fw-bold"
                                    for="{{ form.is_closed.id_for_label }}">Closed</label>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end mt-4 pt-3 border-top">
                        <a href="{% url 'jobapp:admin-jobs' %}" class="btn btn-light text-muted me-2">Cancel</a>
                        <button type="submit" class="btn btn-primary px-4">
                            <i class="fas fa-save me-2"></i> Create Job
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
    var quillOptions = {
        theme: 'snow',
        modules: {
            toolbar: [
                ['bold', 'italic', 'underline'],
                [{ 'list': 'ordered' }, { 'list': 'bullet' }],
                ['clean']
            ]
        }
    };
    var descEditor = new Quill('#description-editor', quillOptions);
    var compEditor = new Quill('#company-description-editor', quillOptions);

    document.querySelector('form').onsubmit = function () {
        document.getElementById('id_description').value = descEditor.root.innerHTML;
        document.getElementById('id_company_description').value = compEditor.root.innerHTML;
    };
</script>
{% endblock %}